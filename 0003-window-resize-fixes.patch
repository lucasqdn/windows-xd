From 28b14604816b8ca977787f5dba0349a17d54ec5b Mon Sep 17 00:00:00 2001
From: tmuntaseer06 <t.muntaseer06@gmail.com>
Date: Sun, 1 Feb 2026 02:45:51 -0800
Subject: [PATCH 3/5]  window resize fixes

---
 app/components/Window.tsx | 156 +++++++++++++-------------------------
 package-lock.json         |  57 ++++++++++++++
 2 files changed, 110 insertions(+), 103 deletions(-)

diff --git a/app/components/Window.tsx b/app/components/Window.tsx
index 56bd88f..a701036 100644
--- a/app/components/Window.tsx
+++ b/app/components/Window.tsx
@@ -128,72 +128,21 @@ export function Window({ id, title, children }: WindowProps) {
 
   console.log('Window render - ID:', id, 'isMaximized:', windowState.isMaximized);
 
-  // For maximized windows, render differently without Rnd
-  if (windowState.isMaximized) {
-    return (
-      <div
-        className="fixed inset-0"
-        style={{ 
-          zIndex: windowState.zIndex,
-          bottom: '40px',
-        }}
-        onMouseDown={() => focusWindow(id)}
-        data-window-id={id}
-      >
-        <div className="win98-window w-full h-full flex flex-col">
-          {/* Title Bar */}
-          <div
-            className={`window-title-bar flex items-center justify-between px-1 py-0.5 cursor-default select-none ${
-              isActive ? "win98-titlebar-active" : "win98-titlebar-inactive"
-            }`}
-            onDoubleClick={handleTitleBarDoubleClick}
-          >
-            <div className="flex items-center gap-1 flex-1 overflow-hidden">
-              <span className="text-xs truncate">{title}</span>
-            </div>
-            <div className="flex gap-0.5">
-              <button
-                className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
-                onClick={handleMinimize}
-                aria-label="Minimize"
-              >
-                _
-              </button>
-              <button
-                className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
-                onClick={handleMaximize}
-                aria-label="Restore"
-              >
-                ❐
-              </button>
-              <button
-                className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
-                onClick={handleClose}
-                aria-label="Close"
-              >
-                ✕
-              </button>
-            </div>
-          </div>
-          {/* Window Content */}
-          <div className="flex-1 bg-white w-full">
-            {children}
-          </div>
-        </div>
-      </div>
-    );
-  }
+  // Calculate full screen dimensions
+  const screenWidth = typeof window !== 'undefined' ? window.innerWidth : 1920;
+  const screenHeight = typeof window !== 'undefined' ? window.innerHeight - 40 : 1040; // Subtract taskbar height
 
+  // Always use Rnd but adjust behavior for maximized state
   return (
     <Rnd
-      size={{ 
-        width: windowState.size.width, 
-        height: windowState.size.height 
-      }}
-      position={{ 
-        x: windowState.position.x, 
-        y: windowState.position.y 
-      }}
+      size={windowState.isMaximized 
+        ? { width: screenWidth, height: screenHeight }
+        : { width: windowState.size.width, height: windowState.size.height }
+      }
+      position={windowState.isMaximized 
+        ? { x: 0, y: 0 }
+        : { x: windowState.position.x, y: windowState.position.y }
+      }
       onDragStart={() => setIsDragging(true)}
       onDragStop={(e, d) => {
         setIsDragging(false);
@@ -211,8 +160,8 @@ export function Window({ id, title, children }: WindowProps) {
       dragHandleClassName="window-title-bar"
       style={{ zIndex: windowState.zIndex }}
       onMouseDown={() => focusWindow(id)}
-      disableDragging={false}
-      enableResizing={{
+      disableDragging={windowState.isMaximized}
+      enableResizing={windowState.isMaximized ? false : {
         top: true,
         right: true,
         bottom: true,
@@ -227,45 +176,46 @@ export function Window({ id, title, children }: WindowProps) {
         className={windowClasses}
         data-window-id={id}
       >
-        {/* Title Bar */}
-        <div
-          className={`window-title-bar flex items-center justify-between px-1 py-0.5 cursor-move select-none ${
-            isActive ? "win98-titlebar-active" : "win98-titlebar-inactive"
-          }`}
-          onDoubleClick={handleTitleBarDoubleClick}
-        >
-          <div className="flex items-center gap-1 flex-1 overflow-hidden">
-            <span className="text-xs truncate">{title}</span>
-          </div>
-          <div className="flex gap-0.5">
-            <button
-              className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
-              onClick={handleMinimize}
-              aria-label="Minimize"
-            >
-              _
-            </button>
-            <button
-              className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
-              onClick={handleMaximize}
-              aria-label="Maximize"
-            >
-              □
-            </button>
-            <button
-              className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
-              onClick={handleClose}
-              aria-label="Close"
-            >
-              ✕
-            </button>
+        <div className="win98-window w-full h-full flex flex-col">
+          {/* Title Bar */}
+          <div
+            className={`window-title-bar flex items-center justify-between px-1 py-0.5 ${windowState.isMaximized ? 'cursor-default' : 'cursor-move'} select-none ${
+              isActive ? "win98-titlebar-active" : "win98-titlebar-inactive"
+            }`}
+            onDoubleClick={handleTitleBarDoubleClick}
+          >
+            <div className="flex items-center gap-1 flex-1 overflow-hidden">
+              <span className="text-xs truncate">{title}</span>
+            </div>
+            <div className="flex gap-0.5">
+              <button
+                className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
+                onClick={handleMinimize}
+                aria-label="Minimize"
+              >
+                _
+              </button>
+              <button
+                className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
+                onClick={handleMaximize}
+                aria-label={windowState.isMaximized ? "Restore" : "Maximize"}
+              >
+                {windowState.isMaximized ? '❐' : '□'}
+              </button>
+              <button
+                className="win98-button w-4 h-4 text-[8px] leading-none p-0 flex items-center justify-center"
+                onClick={handleClose}
+                aria-label="Close"
+              >
+                ✕
+              </button>
+            </div>
           </div>
-        </div>
-        
-        {/* Window Content */}
-        <div className="flex-1 overflow-hidden bg-white">
-          <div className="h-full overflow-auto p-2">
-            {children}
+          {/* Window Content */}
+          <div className="flex-1 overflow-hidden bg-white">
+            <div className="h-full overflow-auto p-2">
+              {children}
+            </div>
           </div>
         </div>
       </div>
diff --git a/package-lock.json b/package-lock.json
index 5cb9a22..f09d725 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -2140,6 +2140,14 @@
         "undici-types": "~6.21.0"
       }
     },
+    "node_modules/@types/prop-types": {
+      "version": "15.7.15",
+      "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
+      "integrity": "sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==",
+      "license": "MIT",
+      "optional": true,
+      "peer": true
+    },
     "node_modules/@types/react": {
       "version": "19.2.10",
       "resolved": "https://registry.npmjs.org/@types/react/-/react-19.2.10.tgz",
@@ -5537,6 +5545,29 @@
         }
       }
     },
+    "node_modules/js-dos/node_modules/@types/react": {
+      "version": "18.3.27",
+      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.27.tgz",
+      "integrity": "sha512-cisd7gxkzjBKU2GgdYrTdtQx1SORymWyaAFhaxQPK9bYO9ot3Y5OikQRvY0VYQtvwjeQnizCINJAenh/V7MK2w==",
+      "license": "MIT",
+      "optional": true,
+      "peer": true,
+      "dependencies": {
+        "@types/prop-types": "*",
+        "csstype": "^3.2.2"
+      }
+    },
+    "node_modules/js-dos/node_modules/@types/react-dom": {
+      "version": "18.3.7",
+      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz",
+      "integrity": "sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==",
+      "license": "MIT",
+      "optional": true,
+      "peer": true,
+      "peerDependencies": {
+        "@types/react": "^18.0.0"
+      }
+    },
     "node_modules/js-dos/node_modules/react": {
       "version": "18.3.1",
       "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
@@ -5565,6 +5596,21 @@
         "react": "^15.3.0 || ^16.0.0 || ^17.0.0 || ^18.0.0"
       }
     },
+    "node_modules/js-dos/node_modules/react-dom": {
+      "version": "18.3.1",
+      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
+      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
+      "license": "MIT",
+      "optional": true,
+      "peer": true,
+      "dependencies": {
+        "loose-envify": "^1.1.0",
+        "scheduler": "^0.23.2"
+      },
+      "peerDependencies": {
+        "react": "^18.3.1"
+      }
+    },
     "node_modules/js-dos/node_modules/react-is": {
       "version": "18.3.1",
       "resolved": "https://registry.npmjs.org/react-is/-/react-is-18.3.1.tgz",
@@ -5610,6 +5656,17 @@
         }
       }
     },
+    "node_modules/js-dos/node_modules/scheduler": {
+      "version": "0.23.2",
+      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
+      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
+      "license": "MIT",
+      "optional": true,
+      "peer": true,
+      "dependencies": {
+        "loose-envify": "^1.1.0"
+      }
+    },
     "node_modules/js-tokens": {
       "version": "4.0.0",
       "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
-- 
2.46.2.windows.1

