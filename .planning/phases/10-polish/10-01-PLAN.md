---
phase: 10-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/globals.css
  - app/components/Window.tsx
autonomous: true

must_haves:
  truths:
    - "Window maximize animation is smooth and distinct from restore"
    - "Windows show visual feedback during drag operations"
    - "All window state transitions are smooth with no jank"
  artifacts:
    - path: "app/globals.css"
      provides: "Window animation keyframes and classes"
      min_lines: 50
      contains: "@keyframes windowMaximize"
    - path: "app/components/Window.tsx"
      provides: "Animation class application logic"
      min_lines: 200
  key_links:
    - from: "app/components/Window.tsx"
      to: "app/globals.css"
      via: "CSS class names"
      pattern: "window-maximizing|window-dragging"
---

<objective>
Add enhanced window animations for maximize, drag, and state transitions.

Purpose: Make window interactions feel smooth and authentic to Windows 98 UX
Output: Complete window animation system with all state transitions
</objective>

<execution_context>
@/Users/lucas/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/lucas/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-polish/10-CONTEXT.md
@.planning/phases/10-polish/10-RESEARCH.md
@app/globals.css
@app/components/Window.tsx
</context>

<tasks>

<task type="auto">
  <name>Add maximize animation and drag feedback to CSS</name>
  <files>app/globals.css</files>
  <action>
Extend the existing window animations (lines 198-242) with new animations:

1. **Add maximize animation keyframe** (after windowRestore):
```css
@keyframes windowMaximize {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 1;
    transform: scale(1.02);
  }
}
```

2. **Add maximize class**:
```css
.window-maximizing {
  animation: windowMaximize 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}
```

3. **Add drag feedback class**:
```css
.window-dragging {
  cursor: move;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  transition: box-shadow 0.1s ease-out;
}
```

4. **Add resize feedback class**:
```css
.window-resizing {
  transition: none; /* Disable transitions during resize for performance */
}
```

These should be added in the "Window Animations" section alongside the existing windowOpen, windowMinimize, and windowRestore keyframes.
  </action>
  <verify>
Run: `npm run build`
Check that build succeeds with no CSS errors.
Visually inspect `app/globals.css` to confirm new animations added after line 242.
  </verify>
  <done>
CSS file contains windowMaximize keyframe, .window-maximizing, .window-dragging, and .window-resizing classes with proper timing and easing.
  </done>
</task>

<task type="auto">
  <name>Apply animation classes in Window component</name>
  <files>app/components/Window.tsx</files>
  <action>
Update the Window component to apply the new animation classes:

1. **Add animation state tracking**:
```typescript
const [animationClass, setAnimationClass] = useState<string>('');
const [isDragging, setIsDragging] = useState(false);
const [isResizing, setIsResizing] = useState(false);
```

2. **Update the className logic** to include new animation classes:
```typescript
const windowClasses = [
  'window',
  animationClass,
  isDragging && 'window-dragging',
  isResizing && 'window-resizing',
].filter(Boolean).join(' ');
```

3. **Add drag handlers** for react-rnd:
```typescript
<Rnd
  onDragStart={() => setIsDragging(true)}
  onDragStop={() => setIsDragging(false)}
  onResizeStart={() => setIsResizing(true)}
  onResizeStop={() => setIsResizing(false)}
  // ... existing props
>
```

4. **Update maximize handler** to use distinct animation:
```typescript
// In the maximize button click handler or useEffect watching windowState
useEffect(() => {
  if (windowState === 'maximized' && prevState !== 'maximized') {
    setAnimationClass('window-maximizing');
    const timer = setTimeout(() => setAnimationClass(''), 200);
    return () => clearTimeout(timer);
  }
  // ... existing minimize/restore logic
}, [windowState]);
```

5. **Ensure existing animations still work**: Keep the window-opening, window-minimizing, and window-restoring logic intact.
  </action>
  <verify>
1. Run: `npm run dev`
2. Open http://localhost:3000
3. Test window interactions:
   - Open a window: Should have smooth opening animation (existing)
   - Drag a window: Should show enhanced shadow while dragging
   - Maximize a window: Should have smooth maximize animation
   - Minimize a window: Should animate to taskbar (existing)
   - Restore a window: Should animate from taskbar (existing)
4. Check console for no errors
  </verify>
  <done>
Window component applies animation classes correctly. All window state transitions (open, close, minimize, maximize, restore, drag, resize) are smooth with proper visual feedback. No animation conflicts or jank.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Enhanced window animations system with maximize, drag, and resize visual feedback</what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Open http://localhost:3000
3. Test all window animations:
   - **Open animation**: Click any desktop icon → window should fade in and scale slightly
   - **Drag feedback**: Click and drag window title bar → enhanced shadow appears during drag
   - **Maximize animation**: Click maximize button → smooth transition to fullscreen
   - **Minimize animation**: Click minimize button → window scales down to taskbar
   - **Restore animation**: Click taskbar button → window scales back up from taskbar
   - **Resize feedback**: Drag window edge to resize → no animation jank during resize
4. Open multiple windows and test state transitions rapidly
5. Verify 60fps performance (open DevTools Performance tab if needed)
6. Expected behavior: All animations smooth, no layout shift, no jank
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
- [ ] CSS build succeeds with no errors
- [ ] All animation keyframes present in globals.css
- [ ] Window component applies correct classes for each state
- [ ] No animation conflicts or double-animations
- [ ] Smooth 60fps performance during all transitions
- [ ] Visual feedback present for drag and resize operations
</verification>

<success_criteria>
- Window maximize has distinct smooth animation (200ms)
- Dragging windows shows enhanced shadow feedback
- Resizing windows has no animation jank
- All existing animations (open, minimize, restore) still work
- No console errors or TypeScript errors
- User verification confirms smooth, authentic Windows 98 feel
</success_criteria>

<output>
After completion, create `.planning/phases/10-polish/10-01-SUMMARY.md`
</output>
